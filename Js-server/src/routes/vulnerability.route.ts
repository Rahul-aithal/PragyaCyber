import { Router } from "express";
import { vulnerability } from "../controllers";
import verifyJWTToken from "../middleware/VerifyJWT.middleware";
import verifyReport from "../middleware/VerifyReport.middleware";

const router = Router();

router.post(
  "/",
  verifyJWTToken,
  verifyReport,
  vulnerability.createVulnerability
);
router.put("/:id", verifyJWTToken, vulnerability.updateVulnerability);
router.put("/:id", verifyJWTToken, vulnerability.toggleVulnerabilityPass);
router.put("/:id", verifyJWTToken, vulnerability.toggleVulnerabilityFail);
router.delete(
  "/:id",
  verifyJWTToken,
  verifyReport,
  vulnerability.deleteVulnerability
);

export default router;
