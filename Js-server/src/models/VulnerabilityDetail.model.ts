import mongoose from "mongoose";

const VulnerabilityDetailSchema = new mongoose.Schema({
  name: { type: String, required: true },
  desc: { type: String },
  impacts: [
    {
      name: String,
      desc: String,
    },
  ],
  cvssScore: Number,
  mitigations: [
    {
      name: String,
      desc: [String],
    },
  ],
  evidences: {
    type: [mongoose.Schema.ObjectId],
    ref: "Evidence",
  },
  type: {
    enum: ["criticals", "highs", "mediums", "lows"],
  },
});

const VulnerabilityDetail = mongoose.model(
  "VulnerabilityDetail",
  VulnerabilityDetailSchema
);

export default VulnerabilityDetail;
